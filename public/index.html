<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Online 2 Spieler Spiel</title>
<style>
  body { background:#111; }
  canvas { background:#222; display:block; margin:auto; }
</style>
</head>
<body>

<h2 style="text-align:center;color:white;">Bewegen mit W A S D</h2>
<canvas id="game" width="600" height="400"></canvas>

<script>
const ws = new WebSocket(
  location.protocol === "https:" ? 
  "wss://" + location.host : 
  "ws://" + location.host
);

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let me = { x:100, y:100 };
let other = { x:300, y:200 };

ws.onmessage = e => {
  other = JSON.parse(e.data);
};

document.addEventListener("keydown", e => {
  if (e.key === "w") me.y -= 5;
  if (e.key === "s") me.y += 5;
  if (e.key === "a") me.x -= 5;
  if (e.key === "d") me.x += 5;
  ws.send(JSON.stringify(me));
});

function draw(){
  ctx.clearRect(0,0,600,400);

  ctx.fillStyle="blue";
  ctx.fillRect(me.x, me.y, 30, 30);

  ctx.fillStyle="red";
  ctx.fillRect(other.x, other.y, 30, 30);

  requestAnimationFrame(draw);
}
draw();
</script>

</body>
</html>
